<!DOCTYPE html>
<html>

<head>
    <title>Move Brick</title>
    <link href="./style.css" rel="stylesheet">
</head>

<body>
    <canvas id="canv"></canvas>
    <script src="Utilities.js"></script>
    <script src="Time.js"></script>
    <script src="Component.js"></script>
    <script src="GameObject.js"></script>
    <script src="PlayerDrawComponent.js"></script>
    <script src="PlayerUpdateComponent.js"></script>
    <script src="PlayerGameObject.js"></script>
    <script src="EnemyDrawComponent.js"></script>
    <script src="EnemyUpdateComponent.js"></script>
    <script src="EnemyGameObject.js"></script>

    <script>
        "use strict"

        //setup the canvas
        let { canvas, ctx } = getCanvas()
        let gameObjects = []

        //check for arrow key input
        document.addEventListener("keydown", (e) => detectKeyDown(e))
        document.addEventListener("keyup", (e) => detectKeyUp(e))
        let leftArrowPress = false
        let rightArrowPress = false
        let upArrowPress = false
        let downArrowPress = false

        //define the model
        let playerX = 100
        let playerY = 100
        let playerW = 50
        let playerH = 50
        let leftBoundary = 0
        let rightBoundary = canvas.width
        let topBoundary = 0
        let bottomBoundary = canvas.height

        //create enemies
        let numEnemies = 5
        for (let i = 0; i < numEnemies; i++) {
            let offset = (canvas.width / 5) 
            let enemyX = 50 + offset * i
            let enemyY = 0
            let enemyW = 25
            let enemyH = 25

            gameObjects.push(new EnemyGameObject(enemyX, enemyY, enemyW, enemyH))
        }

        //create player
        let player = new PlayerGameObject(playerX, playerY, playerW, playerH)
        gameObjects.push(player)


        function draw() {
            //draw background
            ctx.fillStyle = "grey"
            ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)

            //draw player
            player.draw()

            //draw enemies
            for (let enemy of gameObjects) {
                enemy.draw(ctx)
            }

        }

        function update() {
            player.update()
        }

        function tick() {
            update()
            draw()
            Time.timePassed += Time.secondsBetweenFrame
        }


        //run it
        setInterval(tick, Time.millisecondsBetweenFrames)

    </script>


</body>